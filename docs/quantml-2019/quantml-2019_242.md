# 【重磅】VNPY 2.0 正式发布，拥抱 Python3！

> 原文：[`mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290862&idx=1&sn=d93927145bce596f4194483ecf52c8e3&chksm=802dc37bb75a4a6d495f4974bf0dcf7b05f57d0ba1febfc5469ca74ec9ee4972a796498eb748&scene=27#wechat_redirect`](http://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290862&idx=1&sn=d93927145bce596f4194483ecf52c8e3&chksm=802dc37bb75a4a6d495f4974bf0dcf7b05f57d0ba1febfc5469ca74ec9ee4972a796498eb748&scene=27#wechat_redirect)

![](img/7976c8b0ed1c55dc0294e10b5472cc22.png)**标星★公众号**，第一时间获取最新研究

**本文由 VN.PY 作者独家授权**

**近期原创文章：**

## ♥ [基于无监督学习的期权定价异常检测（代码+数据）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290562&idx=1&sn=dee61b832e1aa2c062a96bb27621c29d&chksm=802dc257b75a4b41b5623ade23a7de86333bfd3b4299fb69922558b0cbafe4c930b5ef503d89&token=1298662931&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [5 种机器学习算法在预测股价的应用（代码+数据）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290588&idx=1&sn=1d0409ad212ea8627e5d5cedf61953ac&chksm=802dc249b75a4b5fa245433320a4cc9da1a2cceb22df6fb1a28e5b94ff038319ae4e7ec6941f&token=1298662931&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [深入研读：利用 Twitter 情绪去预测股市](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290402&idx=1&sn=efda9ea106991f4f7ccabcae9d809e00&chksm=802e3db7b759b4a173dc8f2ab5c298ab3146bfd7dd5aca75929c74ecc999a53b195c16f19c71&token=1330520237&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [Two Sigma 用新闻来预测股价走势，带你吊打 Kaggle](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290456&idx=1&sn=b8d2d8febc599742e43ea48e3c249323&chksm=802e3dcdb759b4db9279c689202101b6b154fb118a1c1be12b52e522e1a1d7944858dbd6637e&token=1330520237&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [利用深度学习最新前沿预测股价走势](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290080&idx=1&sn=06c50cefe78a7b24c64c4fdb9739c7f3&chksm=802e3c75b759b563c01495d16a638a56ac7305fc324ee4917fd76c648f670b7f7276826bdaa8&token=770078636&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [一位数据科学 PhD 眼中的算法交易](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290118&idx=1&sn=a261307470cf2f3e458ab4e7dc309179&chksm=802e3c93b759b585e079d3a797f512dfd0427ac02942339f4f1454bd368ba47be21cb52cf969&token=770078636&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [基于 RNN 和 LSTM 的股市预测方法](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290481&idx=1&sn=f7360ea8554cc4f86fcc71315176b093&chksm=802e3de4b759b4f2235a0aeabb6e76b3e101ff09b9a2aa6fa67e6e824fc4274f68f4ae51af95&token=1865137106&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [人工智能『AI』应用算法交易，7 个必踩的坑！](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289974&idx=1&sn=88f87cb64999d9406d7c618350aac35d&chksm=802e3fe3b759b6f5eca6e777364270cbaa0bf35e9a1535255be9751c3a77642676993a861132&token=770078636&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [神经网络在算法交易上的应用系列（一）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289962&idx=1&sn=5f5aa65ec00ce176501c85c7c106187d&chksm=802e3fffb759b6e9f2d4518f9d3755a68329c8753745333ef9d70ffd04bd088fd7b076318358&token=770078636&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [预测股市 | 如何避免 p-Hacking，为什么你要看涨？](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289820&idx=1&sn=d3fee74ba1daab837433e4ef6b0ab4d9&chksm=802e3f49b759b65f422d20515942d5813aead73231da7d78e9f235bdb42386cf656079e69b8b&token=770078636&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [如何鉴别那些用深度学习预测股价的花哨模型？](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290132&idx=1&sn=cbf1e2a4526e6e9305a6110c17063f46&chksm=802e3c81b759b597d3dd94b8008e150c90087567904a29c0c4b58d7be220a9ece2008956d5db&token=1266110554&lang=zh_CN&scene=21#wechat_redirect)

## ♥ [优化强化学习 Q-learning 算法进行股市](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653290286&idx=1&sn=882d39a18018733b93c8c8eac385b515&chksm=802e3d3bb759b42d1fc849f96bf02ae87edf2eab01b0beecd9340112c7fb06b95cb2246d2429&token=1330520237&lang=zh_CN&scene=21#wechat_redirect)

**前言**

延迟了 1 个月的样子（从 1 月底到 2 月底），终于在 2019 年 2 月 27 日正式发布了 v2.0 版本，也是**vn.py 项目在 Python 3 上的第一个版本**。

最新 Github 仓库：

> ***https://github.com/vnpy/vnpy***

![](img/78d429d19256a58a6a07337075e54ab0.png)

**给力**

如果说 vn.py 的 v1.0 内版本（v1.0 — v1.9.2）的升级迭代是在一步步摸着石头过河，由下至上一点点把整个项目的框架给摸索了出来，那么 v2.0 内的版本的开发则是先完成整个框架的搭建升级（基于 v1.0 已有的经验），然后由上至下逐步把框架内各个细节的内容丰富和完善。

**发布内容**

**核心相关**

*   接口、引擎、应用的标准抽象类 BaseGateway、BaseEngine、BaseApp；

*   采用 3.7 的 dataclass 简化基础数据类，并支持相关对象的快速生成；

*   分离程序代码和临时文件（json、temp、log 等），多程序部署简洁快速；

*   新加入的邮件引擎结合 QQ 邮箱，实现微信消息实时推送；

*   剥离独立的数据库交互模块，便于同时支持 SQL 和 Mongo（目前只对接了 Sqlite）。

**接口相关**

*   CTP 接口：基于 PyBind11 封装，同时移除了对 vcredist 运行时的依赖；

*   BitMEX 接口：基于 RestClient 和 WebsocketClient 开发，支持 ShadowSocks 代理；

*   IB 接口：基于 IB 官方的 Python API 开发，全功能支持；

*   FUTU 接口：对接富途新的 futu-api 开发。

**应用相关**

*   GUI 界面

*   基于 PyQt5 重新开发；

*   简化组件逻辑增加复用性；

*   改为非默认加载（无界面 Linux 可以直接运行核心而不会再报错）。

*   CTA 策略

*   内嵌 RQData 客户端支持随时获取最新历史数据（支持交易时段内获取之前的日内数据）；

*   自动扫描 strategy 目录以及当前运行时目录下 Python 文件中的策略类，并加载到引擎中；

*   习惯 v1.0 版本中基于 json 的策略配置模式依旧可以使用（配置文件位于.vntrader 目录下）；

*   实盘初始化策略时改为使用独立线程加载历史数据进行回放，避免界面卡顿。

**VNConda**

**5 年来，如果没在以下问题上掉过坑，那都不好意思说是 vn.py 的用户：**

*   搞错 Python 版本（2 vs 3, 32 位 vs 64 位）；

*   没装或者不会装 vcredist（导致 CTP 接口加载不了）；

*   pip 安装由于 GFW 导致速度奇慢（还经常超时失败）；

*   用 conda 安装 talib 导致整个 numpy/pandas 相关包被降级（甚至破坏环境）；

*   MongoDB 装了后不会启动为系统服务；

*   ......

尽管很早就提供了 Windows 上的一键环境初始化脚本 init.bat，一键 vn.py 安装脚本 install.bat 和 install.sh 等快速安装工具，环境的复杂程度还是超过我们的想象：**总有新的坑能让新手栽进去。**

为了彻底这个问题，vn.py 团队从 v1.9.2 开始试验性的推出了 VNConda 这一针对 Python 量化交易专门设计的 Python 发行版，**基于 Anaconda 背后的一系列构建工具开发，直接内嵌了所有 vn.py 所需的运行库，在社区三个月测试后总算是得到了不错的反馈。**

所以 v2.0 的官方推荐安装方法是直接使用 VNConda-2.0-Windows-x86_64，**傻瓜式安装和 Anaconda 几乎一样，过程中有两个勾选框推荐全部勾上！！！**

> *http://link.zhihu.com/?target=https%3A//conda.vnpy.com/VNConda-2.0-Windows-x86_64.exe*

**手动安装**

如果实在手闲不住想要折腾的用户（我们 vn.py 社区就是这么充满了挑战精神），**请准备好 Python 3.7 64 位环境，注意其他的版本不支持！！！**

在发布页面下载最新 release 后解压，运行 install.bat（Windows）或者 install.sh（Ubuntu）来进行安装。

安装完成后，请在 cmd 中运行以下命令安装 RQData 客户端：

```py
pip install --extra-index-url https://rquser:ricequant99@py.ricequant.com/simple/ rqdatac==1.0.0a66
VN Station
```

VN Station 是全新开发的量化交易应用 GUI 管理工具，目前主要支持 vn.py 应用的图形化配置和启动（无需再写 run.py 脚本）。VNConda 安装完成后，会在桌面自动创建 VN Station 的快捷方式，双击打开后会看到如下的登录框：

![](img/f1b2dadee79fe562f78301a898199fff.png)

**VN Station 登录框**

用户名密码请在 vn.py 社区论坛注册获取，点击右上角的微信登录开始注册，最新注册邀请码为 El86Pa1p，登录后会进入到下图的主界面：

> *https://www.vnpy.com/forum/*

![](img/022c5e4822f40d13bf6b7dc2a35f1c2f.png)

VN Station 主界面

点击下方的**“VN Trader”**按钮，弹出目录选择对话框，这里是用来选择你想运行 VN Trader 以及保存相关临时文件的目录（默认在 Windows 系统用户目录下）：

![](img/66fb69be9509bb1669e82530e9565307.png)

选择运行目录

切换好目录后点击**“选择文件夹”**按钮，会弹出 VN Trader 的配置对话框，如下图所示：

![](img/8d0322e6567f56c6899606b559d99b33.png)

配置 VN Trader

勾选想要加载的底层接口以及上层应用模块，如需修改全局配置可以点击右下角的**“配置”**按钮，全局配置文件使用 json 格式：

![](img/6ec935cfc7eb0ce87f0f110b56768301.png)

修改全局配置

点击**“保存”**按钮后回到 VN Trader 配置对话框，点击**“启动”**按钮后就能看到熟悉的 VN Trader 主界面了。

**VN Trader**

主界面和之前的版本几乎没有太大区别，但点击菜单栏的“系统”->“连接 CTP”后，会弹出 CTP 接口的配置对话框，输入以下内容后即可登录： 

*   用户名 username

*   密码 password

*   经纪商编号 brokerid

*   交易服务器地址 td_address

*   行情服务器地址 md_address

auth_code 和 product_info 主要用于 19 年中的 CTP 接入验证，目前留空即可。

![](img/ea246eeae51fac07f64bbccf77715c86.png)

输入 CTP 配置

连接好 CTP 接口后，点击菜单栏的“功能”->“打开 CTA 策略”，则进入到 CTA 策略窗口中：

![](img/5d44bbcb69c14dce0cb9d748dfb9e16a.png)

CTA 策略窗口

和之前版本最大的区别就是可以完全基于图形界面的策略实例创建、参数修改、策略移除、生命周期管理等操作。

如果需要查看可交易的合约代码，请使用主界面菜单栏的“帮助”->“合约查询”工具，点击“查询”按钮就会输出合约信息：

![](img/d8e98cf7ed03dbb3f2a6239480f9e9f8.png)

**后续计划**

2.0 搭好了整个框架，接下来的工作就是快速迭代丰富 vn.py 中的各项细节，移植和重构老版本中的应用。目前的新版本还很稚嫩，欢迎大家测试后给出反馈（直接在 Github 开 Issue）。 

**同时 2019 年社区建设的思路，将会从之前的“授人以鱼”转向“授人以渔”，每个版本发布后将会保证相关文档编写工作及时完成，另外也计划推出相关培训**（免费和收费都有），感兴趣的话请关注！！！

**推荐阅读**

[01、经过多年交易之后你应该学到的东西（深度分享）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289074&idx=1&sn=e859d363eef9249236244466a1af41b6&chksm=802e3867b759b1717f77e07a51ee5671e8115130c66562577280ba1243cba08218add04f1f00&token=449379994&lang=zh_CN&scene=21#wechat_redirect)

[02、监督学习标签在股市中的应用（代码+书籍）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289050&idx=1&sn=60043a5c95b877dd329a5fd150ddacc4&chksm=802e384fb759b1598e500087374772059aa21b31ae104b3dca04331cf4b63a233c5e04c1945a&token=449379994&lang=zh_CN&scene=21#wechat_redirect)

[03、全球投行顶尖机器学习团队全面分析](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289018&idx=1&sn=8c411f676c2c0d92b0dd218f041bee4b&chksm=802e382fb759b139ffebf633ac14cdd0f21938e4613fe632d5d9231dab3d2aca95a11628378a&token=449379994&lang=zh_CN&scene=21#wechat_redirect)

[04、使用 Tensorflow 预测股票市场变动](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289014&idx=1&sn=3762d405e332c599a21b48a7dc4df587&chksm=802e3823b759b135928d55044c2729aea9690f86752b680eb973d1a376dc53cfa18287d0060b&token=449379994&lang=zh_CN&scene=21#wechat_redirect)

[05、使用 LSTM 预测股票市场基于 Tensorflow](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289238&idx=1&sn=3144f5792f84455dd53c27a78e8a316c&chksm=802e3903b759b015da88acde4fcbc8547ab3e6acbb5a0897404bbefe1d8a414265d5d5766ee4&token=2020206794&lang=zh_CN&scene=21#wechat_redirect)

[06、美丽的回测——教你定量计算过拟合概率](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289314&idx=1&sn=87c5a12b23a875966db7be50d11f09cd&chksm=802e3977b759b061675d1988168c1fec06c602e8583fbcc9b76f87008e0c10b702acc85467a0&token=1972390229&lang=zh_CN&scene=21#wechat_redirect)

[07、利用动态深度学习预测金融时间序列基于 Python](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289347&idx=1&sn=bf5d7899bc4a854d4ba9046fdc6fe0d6&chksm=802e3996b759b080287213840987bb0a0c02e4e1d4d7aae23f10a225a92ef6dd922d8006123d&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[08、Facebook 开源神器 Prophet 预测时间序列基于 Python](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289394&idx=1&sn=24a836136d730aa268605628e683d629&chksm=802e39a7b759b0b1dcf7aaa560699130a907716b71fc9c45ff0e5d236c5ae8ef80ebdb09dbb6&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[09、Facebook 开源神器 Prophet 预测股市行情基于 Python](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289437&idx=1&sn=f0dca7da8e69e7ba736992cb3d034ce7&chksm=802e39c8b759b0de5bce401c580623d0729ecca69d13926479d36e19aff8c9c9e8a20265afff&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[10、2018 第三季度最受欢迎的券商金工研报前 50（附下载）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289358&idx=1&sn=db6e8ab85b08f6e67790ec0e401e586e&chksm=802e399bb759b08d6eec855f9901ea856d0da68c7425cba62791b8948da6ad761a3d88543dad&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[11、实战交易策略的精髓（公众号深度呈现）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289447&idx=1&sn=f2948715bf82569a6556d518e56c1f9e&chksm=802e39f2b759b0e4502d1aaac562b87789573b55c76b3c85897d8c9d88dbf9a0b7ee34d86a4e&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[12、Markowitz 有效边界和投资组合优化基于 Python](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289478&idx=1&sn=f8e01a641be021993d8ef2d84e94a299&chksm=802e3e13b759b7055cf27a280c672371008a5564c97c658eee89ce8481396a28d254836ff9af&token=290397496&lang=zh_CN&scene=21#wechat_redirect)

[13、使用 LSTM 模型预测股价基于 Keras](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289495&idx=1&sn=c4eeaa2e9f9c10995be9ea0c56d29ba7&chksm=802e3e02b759b7148227675c23c403fb9a543b733e3d27fa237b53840e030bf387a473d83e3c&token=1260956004&lang=zh_CN&scene=21#wechat_redirect)

[14、量化金融导论 1：资产收益的程式化介绍基于 Python](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289507&idx=1&sn=f0ca71aa07531bbbdbd33213f0bab89f&chksm=802e3e36b759b720138b3b17a4dd0e198e054b9de29a038fdd50805f824effa55831111ad026&token=1936245282&lang=zh_CN&scene=21#wechat_redirect)

[15、预测股市崩盘基于统计机器学习与神经网络（Python+文档）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289533&idx=1&sn=4ef964834e84a9995111bb057b0fc5dd&chksm=802e3e28b759b73e0618eb1262c53aa0601fbf5805525a7c7ff40dc3db62c7704496611bdbf1&token=1950551577&lang=zh_CN&scene=21#wechat_redirect)

[16、实现最优投资组合有效前沿基于 Python（附代码）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289609&idx=1&sn=c7f0b3e47025862d10bb53b6ab88bcda&chksm=802e3e9cb759b78abf6b8b049c59bf18ccfb2ead7580d1f557d36de2292f59dcbd94dcd41910&token=2085008037&lang=zh_CN&scene=21#wechat_redirect)

[17、精心为大家整理了一些超级棒的机器学习资料（附链接）](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289615&idx=1&sn=1cdc89afb997d0c580bf0cef296d946c&chksm=802e3e9ab759b78ce9f0cd152a680d4a413d6c8dcb02a7a296f4091993a7e4137e7520394575&token=2085008037&lang=zh_CN&scene=21#wechat_redirect)

[18、海量 Wind 数据，与全网用户零距离邂逅！](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289623&idx=1&sn=28a3600fd7a72d7be00b066ca0f98244&chksm=802e3e82b759b7943f43a4f6ef4a91e4153fa6b8210de9590235fa8ee66eb9811ce177054dbc&token=1389401983&lang=zh_CN&scene=21#wechat_redirect)

[19、机器学习、深度学习、量化金融、Python 等最新书籍汇总下载](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289640&idx=1&sn=34e94fcbe99052b8e7381ecc48a36dc0&chksm=802e3ebdb759b7ab897cd329a680715b6f8294e63550ddf0c57b9e1320b2b7d1408c6fdca0c7&token=1389401983&lang=zh_CN&scene=21#wechat_redirect)

[20、各大卖方 2019 年 A 股策略报告，都是有故事的人！](https://mp.weixin.qq.com/s?__biz=MzAxNTc0Mjg0Mg==&mid=2653289725&idx=1&sn=4b65cd1fb8331438e4c0b3d0eae6b51f&chksm=802e3ee8b759b7fe1b94e84d54cc23b0ab05853d5cd227812574b350e9fc2cce9e5f1bc6cb7a&token=1389401983&lang=zh_CN&scene=21#wechat_redirect)

![](img/f0aa286ffe9952b266a73970e50565f7.png)

**扫码关注我们**

![](img/48420b80b7165b5f8e0be398e7b70475.png)
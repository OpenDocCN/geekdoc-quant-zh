# 回溯测试:如何回溯测试、分析、策略等等

> 原文：<https://blog.quantinsti.com/backtesting/>

由[维布·辛格](https://www.linkedin.com/in/vibhu-singh-1b76b6105/)

回溯测试被认为是交易者工具箱中的一个重要工具。如果没有回溯测试，交易者甚至不会想到将资金投入金融市场。

想一想，在你买任何东西之前，不管是手机还是汽车，你都会想了解这个品牌的历史，它的特点等等。你检查它是否值得你的钱。同样的原则也适用于交易，回溯测试可以帮助你。

我们将在本文中讨论以下主题。

*   为什么回溯测试很重要？
*   什么是回溯测试？
*   [回测的前提条件](#prerequisites-for-backtesting)
*   [如何用 Python 做回测？](#how-to-do-backtesting-with-Python)
*   [分析交易策略的表现](#analyzing-the-performance-of-the-trading-strategy)
*   [解释和分析回测结果](#interpreting-and-analysing-backtesting-results)
*   [回溯测试与远期交易测试](#backtesting-vs-walk-forward-trading-testing)
*   [纸上交易&现场交易](#paper-trading-live-trading)
*   [回溯测试中的常见错误](#common-mistakes-in-backtesting)
*   [回测软件](#backtesting-software)

* * *

## 为什么回溯测试很重要？

你知道市场上大多数交易者都赔钱吗？

他们亏损不是因为他们缺乏对市场的了解。而是因为他们的交易决策不是基于可靠的研究和经过测试的交易方法。

他们根据情绪和朋友的建议做出决定，并为了快速致富而过度冒险。如果他们从交易中去除情绪和本能，并在交易前对想法进行回溯测试，那么在市场中交易获利的机会就会增加。

* * *

## 什么是回溯测试？

*回测交易策略是根据历史数据测试交易假设/策略的过程。*

假设你形成了一个假设。这一假设表明，在过去一年中有正回报的证券很可能在未来一个月中有正回报。

*   你会如何检验这个假设？
*   你如何知道这个策略在市场上是否行得通？

通过使用历史数据，你可以进行回溯测试，看看你的假设是否正确。它通过发现交易策略在历史数据上的表现来帮助评估交易策略的可行性。

如果你根据历史数据对你的策略进行回溯测试，并且回报不错，你就有信心用它来交易。如果策略在[历史数据](https://quantra.quantinsti.com/course/day-trading-strategies)上表现不佳，您将放弃或重新评估假设。

* * *

## 回溯测试的先决条件

在你开始回测交易策略之前，你需要考虑一些因素:

*   交易逻辑
*   细分市场
*   数据
*   程序设计语言

让我们详细看看这些因素。

### 回溯测试的交易逻辑/假设

你决定回测一个交易策略，但是在回测之前，你需要对你要回测的东西有一个清晰的概念。这就是这个回溯测试的交易逻辑或假设。

在上面的例子中，您计算了过去一年的证券回报，并检查回报是正还是负。

*   如果是正数，那么你检查股票未来 1 个月的收益。
*   如果是否定的，你什么都不会做。

如果你清楚交易逻辑，那么只有你能回溯测试交易策略，因此这是回溯测试中最关键的一步。

### 为回溯测试选择正确的市场或资产类别

有各种各样的因素，你可以看看，以决定哪一个市场或资产将是最好的交易类型。

这些因素可以是你愿意承担的风险、你期望获得的利润以及你投资的时间，无论是长期还是短期。

例如，[交易加密货币](https://quantra.quantinsti.com/course/crypto-trading-strategies-advanced)可能比其他资产类别风险更高，但可以带来更高的回报，反之亦然。因此，选择正确的市场和资产类别进行折价交易是一个至关重要的决定。

### 回溯测试的数据

一旦你列出了资产的候选名单，你会想要回测你的交易策略。下一步是选择资产的历史数据。您可以从数据供应商或您的经纪人那里获得数据。

重要的是选择高质量的数据，即没有任何错误的数据。如果您选择质量差的数据，那么回溯测试的输出分析将是不正确的和误导的。

你可以在 Quantra 上查看这个[免费课程](https://quantra.quantinsti.com/course/getting-market-data)，获取不同资产类别的市场数据。

### 为回溯测试选择编程语言

你清楚交易逻辑，为交易选择正确的资产，并获得所需的资产数据。

最后一步是决定你将用来回溯测试交易策略的编程语言。实际上，这是个人选择的问题，也是你所熟悉的语言的问题。每种编程语言都有其优点和缺点。

**Python-**[Python](/python-trading/)**是一种免费的开源跨平台语言。它有一个丰富的图书馆，几乎可以完成所有可以想象的任务，还有一个专业的研究环境。它更适合中低频交易，即以分钟及以上的时间尺度进行交易。但是 Python 不适合高频交易。**

****C++ -** C++则适合[高频交易](/high-frequency-trading/)。它有终极的执行速度。它为管理内存和优化执行速度提供了最大的灵活性，但可能会导致微妙的错误，并且很难学习。**

****MATLAB -** MATLAB 是另一种编程语言，拥有多个用于科学计算的数值库。它拥有很高的执行速度，但对零售行业的吸引力仍然较低，因为它相当昂贵。**

**R 是一个专用的统计脚本环境，它是免费的、开源的、跨平台的，并且包含大量可免费获得的统计包，用于非常高级的分析，但是缺乏执行速度，除非操作被矢量化。**

**注意:重要的是要注意，如果你对任何用于回溯测试的编程语言都不熟悉，那不是问题。不妨碍你回测自己的交易策略。也可以从微软 Excel 开始。**

**举例来说，在本文的下一部分，我们将演示如何用 Python 对交易策略进行回溯测试。**

* * *

## **如何用 Python 做回测？**

**要了解如何使用 Python 对交易策略进行回溯测试，请观看这段强烈推荐的视频，视频内容是关于如何使用 Python 进行交易和投资。它从[金融市场](https://quantra.quantinsti.com/course/financial-time-series-analysis-trading)的角度向你介绍 Python 编程的基础。**

### **回溯测试交易策略示例**

**我们将要进行回溯测试的策略是基于移动平均线的概念。[移动平均值](/moving-average-trading-strategies/)是指定数据字段的平均值，例如给定的一组连续周期的价格。**

**当新数据可用时，通过丢弃最旧的[值](https://quantra.quantinsti.com/course/Value-Strategy-Forex)并添加最新的值来计算数据的平均值。
交易逻辑很简单。**

*   **当短期移动平均线(50 天移动平均线)在长期移动平均线(200 天交叉线)上方交叉时，我们买入该证券。这也被称为**黄金交叉**。**
*   **当短期均线穿越长期均线下方时，我们卖出。这被称为**死亡交叉**。**

**我们将按照以下步骤对上述交易策略进行回溯测试。**

**![Moving Average Backtesting Flow](img/7a8406337ced7aefb41403996601d6f6.png)

Moving Average Backtesting Flow** 

### **为回溯测试获取价格数据**

**我们将对微软股票进行回溯测试。为此，您需要获得微软股票的价格数据。我们将使用雅虎！财务获取数据。**
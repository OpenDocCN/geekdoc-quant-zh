# 证券主系统说明

> 原文：<https://blog.quantinsti.com/securities-master-system/>

![Securities Master System](img/2557bb0cb6abd23c68ab580ec28a67ca.png)

Java 开发人员 Gasa Mzolo

作为一名开发者，我们只需点击一个按钮，就可以获得大量的技术，我们中的许多人往往关心从头构建一个程序并最终看到它工作的乐趣。希望这种需求不会从一种更高的力量改变，这种力量基本上让我们的内心充满了足够的压力，如果这种压力转化为毒药，就会杀死一整群老鼠。然而，他们确实让我们心中充满了快乐，对吗？！这些更高的权力只关心最终产品的工作，而不关心它是如何建造的艺术。同样，还有许多程序员不认为是艺术的工作，这就是我今天的重点。

数据库设计和管理是我们经常要做的工作之一。在计算投资领域，就像在编程领域一样，我们经常关注 alpha 模型，以便在将系统投入生产之前生成最佳的回溯测试夏普比率。众所周知，数据，或者更确切地说是信息，在实际程序或 alpha 模型的成功中扮演着关键的角色。没有数据或信息，它只是未来的一个原型。

一个证券主数据库就像一个[算法交易策略](https://blog.quantinsti.com/algorithmic-trading-strategies/)和执行引擎一样好。这项服务帮助我们获得、储存、清洗和出口它。此外，迈克尔霍尔斯-摩尔(Michael Halls-Moore)表示，证券主数据是一个全组织范围的数据库，存储各种资产类别的各种金融工具的基本面、定价和交易数据。它以一致的方式提供对这些信息的访问，供风险管理、清算/结算和自营交易等其他部门使用。

HFT 公司通常考虑的一些工具如下:

*   股票
*   股权期权
*   指数
*   外汇
*   利率
*   期货
*   商品
*   债券-政府和企业
*   衍生品-上限、下限、互换

此外，Halls-Moore 指出，证券主数据库通常由开发人员和数据专家组成的团队来确保金融机构内的高可用性。

### 使用证券大师的原因(扩展)

#### 风险管理

*   准确评估风险
*   优化信贷政策
*   降低运营风险

#### 交易执行

*   减少交易失败
*   降低执行成本
*   减少资本支出

#### 法规遵循

*   类似于风险管理

#### 客户体验

*   提高客户满意度
*   提高员工生产力
*   自动启动客户端

### 使用的数据集

股票的 EOD 数据很容易获得。有许多服务通过网络可用的 API 提供免费访问:

*   雅虎财经
*   谷歌金融
*   QuantQuote(仅 S&P500 EOD 数据)
*   EODData(需要注册)
*   Quandl

手动下载单个证券的历史数据很简单，但如果每天需要下载许多股票，就会变得非常耗时。因此，我们的证券大师的一个重要组成部分将是自动更新数据集。

### 存储数据的方法

存储数据有多种方法，下面将重点介绍这些方法。只是要注意，这些都是各有利弊的。

#### 平面文件存储

平面文件通常使用逗号分隔变量(CSV)格式，这种格式将二维数据矩阵存储为一系列行，列数据通过分隔符(通常是逗号，但也可以是空格，如空格或制表符)分隔。对于谷歌定价数据，每一行都代表 OHLC 基模的一个交易日(即交易期间的开盘价、最高价、最低价和收盘价)。

优势:

*   简单
*   能够被大量压缩以供下载

缺点:

*   性能差
*   缺乏查询能力

#### 文档存储

Java 开发人员最不可能使用的是文档存储。人们会发现存在大量的文档存储，它们与 RDBMS 系统(下面讨论)有很大的不同，因为没有表模式的概念。取而代之的是集合和文档，它们分别与表和记录最为相似。

优势:

*   适合基本数据或元数据

缺点:

*   不适用于高分辨率价格数据等时间序列

#### 关系数据库管理系统

这些系统是开发人员最喜欢的，当然可以与平面文件结合使用。顾名思义，这个系统将数据相互关联。它能够通过每个数据表与下一个数据表之间的关系，几乎以一种对象的形式来表示金融工具。对于那些喜欢面向对象语言的人来说，有些技术，比如 Hibernate，允许他们在从可能选择的数据源中提取数据后，通过文档存储将数据映射到某个表中。这已经使用了所有三种存储数据方法的组合。

**优势**

*   安装简单
*   独立于平台
*   易于查询和集成
*   性能优化

**缺点**

*   定制的复杂性
*   由于大量存储过程等原因，难以获得更高的性能。

### 历史数据结构

为了简单起见，以对象形式存储/表示数据更安全。这使得数据库映射变得容易，因为我们已经看到了使用关系数据库的好处。这使我们能够分离数据的不同部分，并使用特定的键和标准将它们重新组合在一起。

Halls-Moore 重点介绍的对象如下:

*   **交易所** -数据的最终原始来源
*   **供应商** -从以下来源获得的特定数据点
*   **工具/代码** -股票或指数的代码/符号，以及基础公司或基金的公司信息。
*   **价格** -特定证券在特定日期的实际价格。
*   **公司行动** -调整定价数据所需的所有股票分割或股息调整的列表(这可能导致一个或多个表格)。
*   **国定假日** -为了避免将交易假日误归类为缺失数据错误，存储国定假日和交叉引用会很有用。

还建议将多个供应商来源结合起来以确保准确性，因为他们使用不同的方法来解析 tickers。这就把我们带到了下一个话题，数据完整性、评估、标准化和准确性。

### 数据完整性、标准化和准确性

历史定价数据容易出现各种错误。这些错误中的许多依赖于人工判断来决定如何进行。当然，通过适度使用数据分析工具来自动通知此类错误是可能的，但这种解决方案很难实现自动化。例如，霍尔斯-摩尔指出，一个人应该根据使用多少标准差以及在什么样的回望期内选择被告知峰值的阈值。他进一步指出，太高的标准差会错过一些峰值，但太低和许多不寻常的新闻公告会导致假阳性。据我们所知，这些会对您的夏普比率结果产生重大影响。因此，处理这些问题时应格外小心。

以下是 Halls-Moore 强调的数据供应商可能出现的常见错误类型:

*   公司行为-对股票分割和股息调整的错误处理。人们必须绝对肯定这些公式已经被正确地执行了。
*   峰值——定价点大大超过一定的历史波动水平。这里必须小心，因为这些尖峰确实会发生——参见 5 月份的闪电崩盘，这是一个可怕的例子。当股票分割发生时，没有考虑股票分割也可能导致峰值。尖峰过滤-脚本用于通知交易者这种情况。
*   无 OHLC 汇总的 OHLC 数据，如来自雅虎/谷歌的数据，特别容易出现“坏分笔成交点汇总”的情况，即较小的交易所处理的小交易远远高于当天的“主要”交易所价格，从而导致汇总后的最大值/最小值过度膨胀。这与其说是一个“错误”，不如说是一个需要警惕的问题。
*   丢失数据-丢失数据可能是由于在特定时间段内缺少交易(常见于流动性差的小盘股的秒/分钟解析数据)、交易假期或简单的交易系统错误造成的。缺失的数据可以被填充(即，用先前的值填充)、内插(线性或其他方式)或忽略，这取决于交易系统。

### 大数据和 GIGO(垃圾输入-垃圾输出)

这个术语是 IBM 技术人员和讲师 George Fuechsel 的发明，根据普林斯顿大学的一篇文章，该术语用于“主要是为了引起对这样一个事实的注意，计算机将毫无疑问地处理最无意义的输入数据(垃圾输入)并产生无意义的输出(垃圾输出)”。Halls-Moore 指出，使用准确、及时的数据来为 alpha 模型提供信息是至关重要的，否则结果往好里说会很差，往坏里说会完全不正确。因此，如果系统投入生产，这将导致巨大的损失。

大数据采用类似矢量的形式，由数量、速度和多样性组成。大数据不同于常规数据，因为数据集非常庞大。因此，它无法通过传统的硬件和软件进行分析，因为传统的硬件和软件只能处理兆字节和千字节的数据，而大数据工具可以用来处理太字节和太字节大小的数据。如果你的算法还考虑到新闻出版物、Twitter 和脸书供稿，就自动化交易而言，大数据的创建速度会非常高。这也类似于人们进入他们系统的各种数据，因为新闻馈送是非结构化的，需要在考虑任何分析之前首先进行分类。

一些机器可读新闻源的供应商，如德意志交易所(Deutsche brse)试图提供 AlphaFlash，它们是:

*   灵活性:信息必须允许新事件的快速合并。该事件可以是特定的新经济报告，即使该事件可能仅在一个场合具有影响市场的重要意义。
*   深度和广度:深入挖掘主流市场事件。这是在日常环境中系统地扩展其产品的深度和广度。
*   计划外事件:这些可能是计划在某一天发布的公告，但没有具体的时间，如季度收益更新或公司依法必须宣布的意外事件，因为它可能对市场产生重大影响。数据由 AlphaFlash 处理并自动提取，然后作为 AlphaFlash 消息发送给客户端。

### 自动化流程和提高效率

消除系统中的任何低效率并自动化数据的整个生命周期是拥有自动化系统的核心实践之一。从数据的获取、清理到验证、存储、评估和使用，所有部分都需要尽可能高效，因为正如前面提到的，没有数据，尤其是干净的数据，你的软件就像一个原型一样好。

就如何提取数据而言，比如说，从数据存储的位置提取数据，有许多方面可以优化。优化查询(在 RDBMS 的上下文中)有许多考虑因素，我将重点介绍事务管理。事务可以定义为一个不可见的工作单元，它由几个操作组成，为了保持数据的完整性，这些操作要么全部执行，要么都不执行。就像交易执行是一个事务一样，其中涉及的操作也被认为是一个事务。

事务的属性如下:

*   原子性:这意味着不可分割性；任何不可分割的操作(要么完全完成，要么根本不完成)都被称为原子操作。
*   **一致性**:事务必须将持久数据从一种一致状态转换到如果在处理过程中出现故障，数据必须恢复到事务之前的状态。
*   **隔离**:事务之间不应该互相影响。进行中的事务尚未*提交*或*回滚*，必须与其他事务隔离。虽然几个事务可能同时运行，但对每个事务来说，所有其他事务都应该在它之前或之后完成；所有此类并发事务必须有效地按顺序结束。
*   **持久性**:一旦事务成功提交，由该事务提交的状态改变必须是持久的和持久的，不管随后发生的任何失败。

因此，交易可以以两种方式结束；提交(意味着事务的每一步都执行成功)或回滚(保证不会因为前面步骤中的错误而执行任何步骤)。

事务管理的许多其他方面将在后面的文章中讨论，因为它超出了本文的范围。

最后，数据的自动下载可以用像 Windows 中的 bat 文件一样简单的东西来完成，放在任务调度器中，它可以在某一点启动你的软件，并在低频交易系统的交易日结束时下载数据，或者在市场开放时启动你的软件。然后，用户可以根据软件所在的位置激活电子邮件通知或短信通知。这显然会涉及到软件中固有的所有过程。

### 证券主系统的体系结构

我个人喜欢证券主系统的地方，也是我认为对一个人的交易软件有效工作至关重要的地方，是它采用了许多程序员熟悉的模型-视图-控制器模式。这种模式的基础是程序被分成三个不同的部分，在某种程度上是出于维护和明显的数据完整性的原因。通过拥有一个分层的系统，并将其与 MVC 模式相结合，可以显著降低错误数据读取对整个算法的影响，因为组件是相互隔离的，从而避免了任何混乱。

就证券主系统的高级架构而言，人们期望的组件将是主数据中心，例如，它包含层次结构和市场指数，并且它将被数据源、下游应用程序和一些内部系统所包围。数据源是前面提到的那些，它们位于数据集成层。下游应用程序是位于表示层的 alpha 模型。

根据 Cognizant 20-20 Insights(IT、咨询和业务流程外包服务领域的领导者，也是 S&P500 的一部分)的说法，该架构的一些突出特点如下:

*   系统中必须存在数据验证规则，以确定数据源的准确性和质量，尤其是来自外部供应商的数据。
*   安全措施必须能够创建审计跟踪，并防止未经授权的数据更改

### 结论

如本文所述，建立证券主系统主要是为了风险管理、交易执行、法规遵从性和客户体验。使用的各种数据集可从各种数据供应商如 Google/Yahoo 获得，并且该数据的评估需要符合标准，因为从数据供应商接收的数据容易出现各种错误，这些错误在收集用于分析的数据中没有考虑到。不要忘记从 Twitter、脸书、RSS 源和机器可读新闻源(如德意志交易所的新闻源)接收的大数据。

存储数据的方式也引导我们如何表示从不同供应商收集的数据，因为关系数据库管理系统的优点允许我们以几乎对象的形式存储数据。当然，为了达到更高的效率，RDBMS 也可以与其他存储数据的方法相结合。在效率方面，我们发现事务管理可以帮助我们大大提高速度，因为我们可以使用四个属性，即原子性、一致性、隔离性和持久性来衡量从 RDBMS 中读取的数据的完整性。最后，就整个系统中涉及的不同层次而言，证券主系统的架构起着至关重要的作用。它所遵循的模型-视图-控制器模式消除了一系列的低效率，这些低效率可能会阻碍交易系统以最佳水平运行。

### 下一步

如果你是一名散户交易者或科技专业人士，想要建立自己的自动化交易平台，今天就开始学习算法交易吧！从基本概念开始，如[自动交易架构](https://blog.quantinsti.com/algorithmic-trading-system-architecture/)、[市场微观结构](https://blog.quantinsti.com/market-microstructure/)、[策略回溯测试系统](https://blog.quantinsti.com/backtesting/)和[订单管理系统](https://blog.quantinsti.com/automated-trading-order-management-system/)。

**更新**

我们注意到一些用户在从雅虎和谷歌金融平台下载市场数据时面临挑战。如果你正在寻找市场数据的替代来源，你可以使用 [Quandl](https://www.quandl.com/) 来获得同样的信息。
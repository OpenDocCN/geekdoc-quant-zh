# 交易决策树分类器第一部分

> 原文：<https://blog.quantinsti.com/decision-tree-classifier-trading-part-1/>

![Trading using Decision Tree Classifier Part 1](img/02d728322aa8c737c1488c2abb5ee499.png)

由[瓦伦·迪瓦卡](https://www.linkedin.com/in/varun-divakar-b862a667/)

这篇博客中的策略不会涉及正常的技术指标，而是一些我自己的创造。此外，我们将看到测试和训练数据上的策略性能之间的差异，以及训练数据大小和预测长度的变化。

与我以前的博客不同，在这里我将使用一个动态的时间框架来获取过去几天的数据。但是在我们开始之前，让我们导入必要的库。

![](img/5164616e3473ef12706e027f8a54a9ce.png)

我已经将要提取的数据的开始日期定义为过去 365 天/ 1 年的日期。您可以使用静态日期格式，但这将有助于您在运行这段代码时获取最新的数据。

接下来，我创建了几个指示器，并更改了一些列的名称，以便以后在代码中引用它们。

![](img/aa8819267570805b0f7751866968c769.png)

我将简要说明我使用的指标。我创建了一个名为“dif”的专栏。这衡量的是收盘价相对于昨天范围的变化。我们正试图检查今天的收盘与昨天的价格波动之间是否有任何关联。在这之后，我创建了一个名为“sec_dif”的列，这是收盘价变化的二阶差。这里我们衡量 dif 相对于昨天范围的变化。

我们还使用另一个称为 diff_v 的指标，该指标用于衡量今天与前一天相比的范围变化。

之后，我计算了市场回报。请注意，这些回报是前瞻性的。由于预测是在一天结束时或就在一天结束前生成的，我们可以简单地将预测的趋势与该回报相乘，并轻松地衡量策略绩效。

![](img/163893692fe6117fc274da132c59d48e.png)

创建指标后，我们分别计算衡量策略绩效和训练算法所需的回报和信号列。我们将使用前一天的回报作为指标的一部分，看看明天的趋势和今天的市场表现之间是否有任何相关性。

![](img/5cdda92d271805dbce967c30d8721f8a.png)

在选择我们的指标后，我们使用最小最大缩放器来缩放数据。该缩放函数将特征值缩小到 0 到 1 的范围内。

![](img/7df160f78f6fee05aae6480ca2af25ac.png)

接下来，我们决定测试数据的大小，在这种情况下，我选择了 20 天，代表最后一个月的数据。

在此之后，我使用了一个日益复杂的[决策树](/use-decision-trees-machine-learning-predict-stock-movements/)分类器，通过添加更多的深度和特征，来看看该算法在这个[决策树](https://quantra.quantinsti.com/course/decision-trees-analysis-trading-ernest-chan)分类器的帮助下预测得有多好。

我将用递增的复杂度(1-9，9 是最复杂的)来绘制策略的性能，并测量这些算法的准确性。

![](img/e092ade2cd5aa8427a4c9836d039513b.png)

![accuracy for complexity](img/4b981b6d4c0cebac745b2d23350701e7.png)

![algo trading graph](img/78cde6ffc5820872e6d44b99fab3c96c.png)

没有明确的迹象表明任何趋势或算法的表现，总的来说，这个结果是非常复杂的。现在，让我们打印列车数据性能并可视化性能。

![](img/b4c975dc5ff0c75805844fc9272d29e6.png)

![algo trading graph_2](img/014f91a64a2163c1b6e0c41d54494435.png)

在这里，观察结果非常清楚。你可以清楚地看到，更复杂的算法在预测趋势方面做得非常好，而不太复杂的算法更像是扔硬币。给定这些训练数据，我们可以期望最复杂的算法在测试数据上表现得更好。但遗憾的是，事实并非如此。正如你所看到的，上图中最近 20 天的表现清楚地表明，所有的算法几乎一样糟糕。这样做的原因是，我们并没有使用截至当天该点的可用数据来进行预测。换句话说，我们不是通过使用在那天之前的整个数据上训练的算法来对最后的数据进行预测，而是我们假设过去(365 天- 20 天)的数据将具有与未来 20 天相似的趋势，但大多数情况下不是这样。让我们通过将预测的天数减少到仅仅 5 天来验证这一点，然后我们可以看到算法的测试数据性能的显著差异。

![algo trading graph_3](img/2d9c11fce775581bc4a35e4e90df9b97.png)

在这里，您可以看到，过度拟合或欠拟合训练数据的算法表现不佳，而具有最佳学习能力的算法具有一致的性能。请注意，您只能看到 9 个算法中的 4 个，因为它们大多数是重叠的。如果您想要验证策略的准确性，您可以使用新的测试数据再次打印包含准确性的代码。在这里，理想情况下，当我们使用时间序列数据时，我们需要使用 LSTM 类型的方法来进行预测。即使用过去“x”天的数据来训练算法，然后预测第二天的数据。这将大大提高你的准确性。我们将在我的下一篇博客中探讨这个问题。

### **下一步**

如果你想学习算法交易的各个方面，那就去看看算法交易(EPAT)中的 T2 高管课程。该课程涵盖了统计学&计量经济学、金融计算&技术和算法&定量交易等培训模块。EPAT 让你具备成为成功交易者所需的技能。[现在报名](https://www.quantinsti.com/epat/)！

*免责声明:股票市场的所有投资和交易都涉及风险。在金融市场进行交易的任何决定，包括股票或期权或其他金融工具的交易，都是个人决定，只能在彻底研究后做出，包括个人风险和财务评估以及在您认为必要的范围内寻求专业帮助。本文提到的交易策略或相关信息仅供参考。T3】*

### **下载 Python 代码**

*   决策树分类器 Python 代码
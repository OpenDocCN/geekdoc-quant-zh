# 基尼指数:决策树、公式和系数

> 原文：<https://blog.quantinsti.com/gini-index/>

由[查妮卡·塔卡](https://www.linkedin.com/in/chainika-bahl-thakar-b32971155/)和[沙古塔·塔西尔达](https://www.linkedin.com/in/shaguftatahsildar/)

决策树通常在实现机器学习算法时使用。决策树的层次结构通过遍历树的节点引导我们到达最终结果。每个节点都由一个属性或特性组成，当我们沿着树向下移动时，这个属性或特性会被进一步分解成更多的节点。但是我们如何决定:

*   哪个属性/特征应该放在根节点？
*   哪些功能将充当内部节点或叶节点？

为了决定这一点，以及如何分裂这棵树，我们使用分裂措施，如基尼指数，信息增益等。在这篇博客中，我们将学习所有关于基尼指数的知识，包括使用基尼指数来分割决策树。

在这个博客中找到一切，它涵盖了:

*   [什么是基尼指数？](#what-is-gini-index)
*   [与执行决策树技术的基尼指数相似的术语](#terms-similar-to-gini-index-for-execution-of-decision-tree-technique)
    *   [分割措施](#splitting-measures)
    *   [信息增益](#information-gain)
*   [熵的相关性](#relevance-of-entropy)
*   [基尼系数公式](#formula-of-gini-index)
*   [基尼指数示例](#example-of-gini-index)
*   [基尼指数的计算](#calculation-of-gini-index)

* * *

## 什么是基尼指数？

基尼指数(Gini Index)或基尼系数(Gini inexture)衡量的是随机选取某个变量时，该变量被错误分类的程度或概率。

但是“不洁”的真正含义是什么呢？

如果所有的元素都属于一个类，那么它可以被称为纯的。基尼系数在 0 和 1 之间变化，

其中，
‘0’表示所有元素都属于某个类或者只存在一个类(纯)，而
‘1’表示元素随机分布在各个类中(不纯)。

基尼系数为“0.5”表示元素平均分布在某些类别中。

* * *

## 用于执行决策树技术的类似基尼指数的术语

我们正在讨论类似于基尼系数的组成部分，以便基尼系数在决策树技术执行中的作用更加清晰。

决策树的本质在于将整个数据集划分为树状的垂直信息结构，以根节点为顶部划分信息的不同部分。

在决策树模型中，每个节点都是一个属性或特征，包含决策树模型的必要信息(按顺序向下)。在决定决策树模型的每个节点时，需要记住以下几点:

*   哪些功能将位于决策树开始的根节点。根节点上的信息应该是整个信息的基础。例如，如果我们要为一只股票创建决策树模型，我们可以在根节点提到这只股票的数据(OHLCV)。
*   决定哪些最准确的要素用作内部节点(沿树垂直向下)，也称为叶节点。

谈到也导致执行决策树技术的其他术语，类似于基尼指数，这些术语如下:

*   分割措施
*   信息增益

### 分割措施

由于不止一个属性参与决策过程，因此有必要确定每个属性的相关性和重要性。因此，将最相关的特征放置在根节点，并通过分割节点进一步向下遍历。

随着我们在树中进一步向下移动，杂质或不确定性的水平降低，从而导致更好的[分类](https://quantra.quantinsti.com/course/trading-machine-learning-classification-svm)或每个节点的最佳分割。信息增益、基尼指数等拆分指标。被用来决定同样的事情。

### 信息增益

信息增益用于确定哪个特征/属性给了我们关于一个类的最大信息。

*   信息增益基于熵的概念，熵是不确定性、杂质或无序的程度。
*   信息增益旨在降低从根节点到叶节点的熵水平。

* * *

## 熵的相关性

熵是数据集中无序度或杂质度的量度。基尼指数是一种旨在降低数据集中熵值的工具。

换句话说，熵是杂质的度量，或者我们可以说，是数据集值的随机性。

低度无序(无无序)意味着杂质水平低。熵是在 0 和 1 之间计算的。数字“1”表示更高水平的无序或更多的杂质。

尽管在数据集中可以存在大于 1 的其他数量的组或类。在[机器学习](https://quantra.quantinsti.com/course/python-machine-learning)(和决策树)的情况下，1 表示相同的意思，即更高层次的无序，也使解释变得简单。因此，决策树模型会将较大的无序度分类为 1。

熵通常是最低的无序(无无序)意味着杂质水平低，较高的无序(最大无序)意味着杂质水平高。测量熵是为了减少更多杂质带来的不确定性。

在下图中，你可以看到一个倒“U”形，代表图中熵的变化。在图像中，x 轴代表数据值，y 轴代表熵值。

![Variation of entropy against data points](img/3524c8cf5b1e51103357be930f3ab9e0.png)

Variation of entropy against data points



上图显示，熵在两个极端(左右两侧)最低(无无序)，在图的中间或倒“U”形曲线处最大(高度无序)。

因此，在两个极端(左和右)，没有熵(杂质)，因为每个类都有属于该类的所有元素。另一方面，在中间，熵线延伸到最高点以创建一个“U”形，其中来自两个类别的所有元素随机分布，这意味着存在熵(杂质)。

从我们的观察中可以清楚地看到，两个极端(左和右)都是纯的，没有熵。

熵的公式

为了找出不确定性或高度无序，熵的公式如下:

$ $ e(s)= \sum_{i=1}^c-p _ I log _ 2p p _ I $ $

其中，
‘p’，表示熵的概率，E(S)表示熵。

* * *

## 基尼指数公式

基尼指数的公式如下:

$$Gini = 1-\sum_{i=1}^n (p_i)^2$$

其中，
‘pi’是对象被分类到特定类别的概率。

在构建[决策树](https://quantra.quantinsti.com/course/decision-trees-analysis-trading-ernest-chan)时，我们倾向于选择基尼系数最小的属性/特征作为根节点。

* * *

## 基尼指数示例

现在让我们看看基尼系数交易的例子。我们将为决策树模型提供一组特定的数据，这组数据对于机器来说是[可读的。](/data-preprocessing/)

现在，让我们使用示例数据，按照以下方式计算过去趋势、未平仓合约、交易量和回报的基尼指数:

| 过去趋势 | 未平仓利息 | 交易额 | 返回 |
| 积极的 | 低的 | 高的 | 向上 |
| 否定的；消极的；负面的；负的 | 高的 | 低的 | 向下 |
| 积极的 | 低的 | 高的 | 向上 |
| 积极的 | 高的 | 高的 | 向上 |
| 否定的；消极的；负面的；负的 | 低的 | 高的 | 向下 |
| 积极的 | 低的 | 低的 | 向下 |
| 否定的；消极的；负面的；负的 | 高的 | 高的 | 向下 |
| 否定的；消极的；负面的；负的 | 低的 | 高的 | 向下 |
| 积极的 | 低的 | 低的 | 向下 |
| 积极的 | 高的 | 高的 | 向上 |

* * *

## 基尼指数的计算

我们现在将使用以下公式计算基尼系数

*   计算过去趋势的基尼指数
*   计算未平仓利息的基尼指数

**计算过去趋势的基尼指数**

由于过去的趋势 10 次中有 6 次是正的，4 次是负的，因此计算如下:

p(过去趋势=正):6/10

p(过去趋势=负):4/10

*   If(过去趋势=正&回报=涨)，概率= 4/6
*   If(过去趋势=正&回报=负)，概率= 2/6

基尼指数= 1 - ((4/6)^2 + (2/6)^2) = 0.45

*   If(过去趋势=负&回报=正)，概率= 0
*   If(过去趋势=负&回报=跌)，概率= 4/4

基尼指数= 1 - ((0)^2 + (4/4)^2) = 0

*   基尼系数的加权和可以计算如下:

过去趋势的基尼指数= (6/10)0.45 + (4/10)0 = 0.27

**计算未平仓合约的基尼指数**

对于未平仓利息，未平仓利息在总共 10 次中有 4 次是高的，6 次是低的，计算如下:

p(未平仓利息=高):4/10

p(未平仓权益=低):6/10

*   If(未平仓利息=高&回报=高)，概率= 2/4
*   If(未平仓利息=高&回报=低)，概率= 2/4

基尼指数= 1 - ((2/4)^2 + (2/4)^2) = 0.5

*   If(未平仓利息=低&回报=高)，概率= 2/6
*   If(未平仓利息=低&回报=低)，概率= 4/6

基尼指数= 1 - ((2/6)^2 + (4/6)^2) = 0.45

*   基尼系数的加权和可以计算如下:

未平仓权益基尼指数= (4/10)0.5 + (6/10)0.45 = 0.47

**计算交易量的基尼指数**

交易量 7 倍高，3 倍低，计算如下:

p(交易量=高):7/10

p(交易量=低):3/10

*   If(交易量=高&回报=涨)，概率= 4/7
*   如果(交易量=高&回报=低)，概率= 3/7

基尼指数= 1 - ((4/7)^2 + (3/7)^2) = 0.49

*   If(交易量=低&回报=高)，概率= 0
*   如果(交易量=低&回报=低)，概率= 3/3

基尼指数= 1 - ((0)^2 + (1)^2) = 0

*   基尼系数的加权和可以计算如下:

交易量基尼指数= (7/10)0.49 + (3/10)0 = 0.34

**基尼指数的属性或特征**

| 属性/特征 | 基尼指数 |
| 过去趋势 | Zero point two seven |
| 未平仓利息 | Zero point four seven |
| 交易额 | Zero point three four |

从上表中，我们观察到“过去的趋势”具有最低的基尼指数，因此，它将被选为决策树如何工作的根节点。

### 确定决策树的子节点或分支(向下的特征)

我们将重复相同的过程来确定决策树的子节点或分支。

我们将为过去趋势的“正”分支计算基尼指数，如下所示:

| 过去趋势 | 未平仓利息 | 交易额 | 返回 |
| 积极的 | 低的 | 高的 | 向上 |
| 积极的 | 低的 | 高的 | 向上 |
| 积极的 | 高的 | 高的 | 向上 |
| 积极的 | 低的 | 低的 | 向下 |
| 积极的 | 低的 | 低的 | 向下 |
| 积极的 | 高的 | 高的 | 向上 |

**计算过去正趋势的未平仓合约基尼指数**

正面过去趋势的未平仓合约 6 次中有 2 次是高的，6 次中有 4 次是低的，正面过去趋势的未平仓合约基尼指数计算如下:

p(未平仓利息=高):2/6

p(未平仓权益=低):4/6

*   If(未平仓利息=高&回报=高)，概率= 2/2
*   If(未平仓利息=高&回报=低)，概率= 0

基尼指数= 1 - (sq(2/2) + sq(0)) = 0

*   If(未平仓利息=低&回报=高)，概率= 2/4
*   If(未平仓利息=低&回报=低)，概率= 2/4

基尼指数= 1 - (sq(0) + sq(2/4)) = 0.50

*   基尼系数的加权和可以计算如下:

未平仓利息的基尼指数= (2/6)0 + (4/6)0.50 = 0.33

**计算交易量的基尼指数**

交易量在 6 次中有 4 次是高的，在 6 次中有 2 次是低的，计算如下:

p(交易量=高):4/6

p(交易量=低):2/6

*   If(交易量=高&回报=涨)，概率= 4/4
*   If(交易量=高&回报=低)，概率= 0

基尼指数= 1 - (sq(4/4) + sq(0)) = 0

*   If(交易量=低&回报=高)，概率= 0
*   如果(交易量=低&回报=低)，概率= 2/2

基尼指数= 1 - (sq(0) + sq(2/2)) = 0

*   基尼系数的加权和可以计算如下:

交易量基尼指数= (4/6)0 + (2/6)0 = 0

**基尼指数的属性或特征**

| 属性/特征 | 基尼指数 |
| 未结清权益 | Zero point three three |
| 交易额 | Zero |

我们将使用“交易量”特征进一步分割节点，因为它具有最小的基尼指数。

* * *

### 结论

基尼系数是一个强有力的衡量数据集中的随机性、杂质或熵的指标。基尼指数旨在减少决策树模型中从根节点(在决策树的顶部)到叶节点(决策树的垂直分支)的杂质。

通过欧内斯特·陈博士提供的关于决策树的[课程，您可以了解如何减少决策树模型中的杂质。你将了解更多不同的分割方法，包括基尼指数、信息增益等。以及如何使用人工智能技术预测市场和寻找交易机会。快乐学习！](https://quantra.quantinsti.com/course/decision-trees-analysis-trading-ernest-chan)

如果你也对发展终身技能感兴趣，这些技能会帮助你提高交易策略。在这个 [algo 交易课程](https://www.quantinsti.com/epat)中，你将接受统计学&计量经济学、编程、机器学习和量化交易方法的培训，因此你精通每一项在量化&算法交易中出类拔萃所必需的技能。现在就了解更多关于 EPAT 的课程吧！

* * *

*<small>免责声明:股票市场的所有投资和交易都涉及风险。在金融市场进行交易的任何决定，包括股票或期权或其他金融工具的交易，都是个人决定，只能在彻底研究后做出，包括个人风险和财务评估以及在您认为必要的范围内寻求专业帮助。本文提到的交易策略或相关信息仅供参考。</small>T3】*
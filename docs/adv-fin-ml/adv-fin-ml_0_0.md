# 序言

**对** ***《金融机器学习进展》的赞誉***

> 在他的新书《金融机器学习进展》中，著名金融学者马尔科斯·洛佩斯·德·普拉多对当前金融界普遍存在的天真且通常统计过拟合的技术进行了精准的抨击。他指出，传统的业务方式在当今高科技金融领域几乎无能为力，而且在许多情况下，实际上更容易亏损。但洛佩斯·德·普拉多不仅仅是揭露金融世界的数学和统计错误。相反，他为金融专业人士提供了一条技术上可靠的路线图，以便他们能够加入机器学习的浪潮。特别令人耳目一新的是作者的实证方法——他的重点是现实世界数据分析，而不是那些在纸面上看起来漂亮但在实践中往往效果不佳的纯理论方法。这本书面向那些已经熟悉统计数据分析技术的金融专业人士，但对于那些想在该领域进行真正尖端工作的读者而言，努力阅读也是非常值得的。”
> 
> **大卫·H·贝利博士**，前复杂系统主管，
> 
> 劳伦斯·伯克利国家实验室。共同发现者
> 
> BBP 水龙头算法
> 
> “金融已从基于历史财务报表的启发式知识汇编发展为一种高度复杂的科学学科，依赖计算机农场实时分析海量数据流。最近在机器学习（ML）方面的显著进展，既充满了机遇，也伴随着风险，特别是在现代金融中应用时。虽然金融提供了非线性和大数据集，这些正是 ML 所擅长的，但它也提供了嘈杂的数据和目前超出标准 ML 技术范围的人为因素。人非圣贤，但如果你真的想搞砸事情，使用计算机吧。在这样的背景下，洛佩斯·德·普拉多博士撰写了第一本全面描述现代 ML 在金融建模中应用的书籍。该书将最新的 ML 技术发展与作者在领先学术和工业机构中数十年的金融经验中获得的重要人生教训融合在一起。我强烈推荐这本令人振奋的书，给那些希望学习金融 ML 的潜在学生，以及教授和指导他们的教师。”
> 
> **彼得·卡尔教授**，金融与风险工程系主任
> 
> 纽约大学坦登工程学院
> 
> “马尔科斯是一位有远见的人， tirelessly 致力于推动金融领域的发展。他的著作全面而巧妙地将理论与应用连接起来。很少能找到一本能够跨越这一鸿沟的书。这本书对投资界的从业者和技术专家来说都是必读之作。”
> 
> **兰登·唐斯**，1QBit 的总裁兼联合创始人
> 
> “想要理解现代投资管理的学者需要阅读这本书。在书中，马尔科斯·洛佩斯·德·普拉多解释了投资组合经理如何利用机器学习来推导、测试和运用交易策略。他从一种非常不寻常的视角出发，结合了学术视角和丰富的行业经验，使他能够详细解释行业内发生的事情以及其运作方式。我怀疑一些读者可能会发现书中某些部分不理解或与之意见相左，但所有对理解机器学习在金融中的应用感兴趣的人都会从阅读这本书中受益。”
> 
> **大卫·伊斯利教授**，康奈尔大学。主席
> 
> 纳斯达克-OMX 经济顾问委员会
> 
> “几十年来，金融一直依赖过于简单的统计技术来识别数据中的模式。机器学习有望改变这一现状，使研究人员能够使用现代非线性和高维技术，类似于在 DNA 分析和天体物理学等科学领域中使用的方法。同时，将这些机器学习算法应用于金融问题建模将是危险的。金融问题需要非常独特的机器学习解决方案。洛佩斯·德·普拉多博士的书是第一本界定了标准机器学习工具在金融领域应用失败原因的书，也是第一本提供针对资产管理者所面临独特挑战的实用解决方案的书。任何想要了解金融未来的人都应该阅读这本书。”
> 
> **弗兰克·法博齐教授**，EDHEC 商学院。编辑
> 
> *投资组合管理期刊*
> 
> “这是一种令人欢迎的转变，摆脱了困扰量化金融的知识垄断。洛佩斯·德·普拉多为所有读者定义了金融的下一个时代：由机器驱动的工业规模科学研究。”
> 
> **约翰·福塞特**，创始人兼首席执行官，Quantopian
> 
> “马尔科斯将一系列宝贵的课程和技巧汇集在一起，为寻求在金融中应用机器学习技术的从业者提供指导。如果机器学习是量化金融工具箱中一种新的且潜在强大的武器，那么马尔科斯的深刻著作充满了有用的建议，可以帮助好奇的从业者避免误入歧途或自食其果。”
> 
> **罗斯·加龙**，Cubist 系统策略负责人。管理
> 
> Point72 资产管理公司董事
> 
> “金融领域的第一次定量创新浪潮是由马科维茨优化引领的。机器学习是第二次浪潮，它将影响金融的每个方面。洛佩斯·德·普拉多的*金融机器学习进展*对那些希望在技术前沿而不是被技术取代的读者来说至关重要。”
> 
> **坎贝尔·哈维教授**，杜克大学。前任会长
> 
> 美国金融协会
> 
> “在当今金融市场中，复杂的算法负责路由订单，海量的金融数据，交易速度以纳秒为单位，该如何理解？在这本重要的书中，马科斯·洛佩斯·德·普拉多提出了一个建立在机器学习基础上的投资管理新范式。这本书清晰地解释了金融机器学习的工具和过程，远非“黑箱”技术。对于学术界和从业者而言，这本书填补了我们在机器时代投资管理理解中的重要空白。”
> 
> **莫琳·欧哈拉教授**，康奈尔大学。前任会长
> 
> 美国金融协会
> 
> “马科斯·洛佩斯·德·普拉多出版了一本极为及时且重要的机器学习书籍。作者的学术与职业一流资质在书页间熠熠生辉——确实，我很难想到更合适的作者来解释这个对于大多数人来说既新颖又陌生的主题的理论和实践方面。无论是新手还是经验丰富的专业人士都能找到富有洞察力的观点，并理解如何以新颖和实用的方式应用这一主题。Python 代码将为初学者提供一个良好的起步，并使他们迅速获得对该主题的实际理解。这本书注定将在这一迅速发展的领域中成为经典。”
> 
> **里卡多·雷博纳托教授**，EDHEC 商学院。前任
> 
> PIMCO 全球利率与外汇分析主管
> 
> “一本关于金融领域机器学习实际应用的力作，充满了如何使用尖端技术（如分数微分和量子计算机）获得洞察力和竞争优势的想法。对金融和机器学习从业者而言都是一本实用的书籍。”
> 
> **科林·P·威廉姆斯博士**，D-Wave 系统公司研究主管

**金融机器学习进展**

**马科斯·洛佩斯·德·普拉多**

![](img/Image00527.jpg)

封面图像：© Erikona/Getty Images

封面设计：Wiley

版权所有 © 2018 约翰·威利父子公司。保留所有权利。

由约翰·威利父子公司出版，位于新泽西州霍博肯。

同时在加拿大出版。

本书所表达的观点属于作者，未必反映其所隶属组织的观点。

本出版物的任何部分不得以任何形式或任何方式复制、存储在检索系统中或传输，包括电子、机械、复印、录音、扫描或其他方式，除非在 1976 年美国版权法第 107 或 108 节的允许范围内，且未经出版商的事先书面许可，或通过支付适当的每份费用向版权清算中心（Copyright Clearance Center, Inc.），地址为 222 Rosewood Drive, Danvers, MA 01923, (978) 750-8400, 传真(978) 646-8600，或通过 [www.copyright.com](http://www.copyright.com) 网上申请。对出版商的许可请求应发送至权限部，约翰·威利与儿子公司（John Wiley & Sons, Inc.），地址为 111 River Street, Hoboken, NJ 07030, (201) 748-6011, 传真(201) 748-6008，或在线访问 [www.wiley.com/go/permissions](http://www.wiley.com/go/permissions)。

责任限制/免责声明：虽然出版商和作者在准备本书时已尽最大努力，但他们对本书内容的准确性或完整性不作任何陈述或保证，并明确拒绝任何关于适销性或特定用途适用性的隐含保证。销售代表或书面销售材料可能不会创建或扩展任何保证。本书中包含的建议和策略可能不适合您的情况。您应在适当时咨询专业人士。出版商和作者均不对任何利润损失或其他商业损害负责，包括但不限于特殊、附带、间接或其他损害。本书中表达的观点为作者个人观点，并不一定反映其所隶属组织的观点。

如需有关我们其他产品和服务的一般信息或技术支持，请在美国拨打 (800) 762-2974 联系我们的客户服务部，国际拨打 (317) 572-3993，或传真 (317) 572-4002。

Wiley 以多种印刷和电子格式以及按需印刷出版。一些在本书标准印刷版中包含的材料可能不包括在电子书或按需印刷中。如果本书提及的媒体如 CD 或 DVD 未包含在您购买的版本中，您可以在 [`booksupport.wiley.com`](http://booksupport.wiley.com) 下载这些材料。有关 Wiley 产品的更多信息，请访问 [www.wiley.com](http://www.wiley.com)。

ISBN 978-1-119-48208-6（精装）

ISBN 978-1-119-48211-6（ePDF）

ISBN 978-1-119-48210-9（ePub）

献给我的合著者和朋友的记忆，

乔纳森·M·博尔温教授，FRSC，FAAAS，

FBAS，FAustMS，FAA，FAMS，FRSNSW

（1951–2016）

我们知道的事情非常少，它们都可以简化为数学推理。当它们不能时，说明我们对它们的认识非常有限且混乱。能够进行数学推理时，使用其他任何推理方法都是极大的愚蠢，就像在黑暗中摸索事物时，身边有一根蜡烛却不去使用它。

— *关于机会法则*，序言 (1692)

约翰·阿巴斯诺特 (1667–1735)

**内容**

1.  关于作者

1.  序言

    1.  第一章 财务机器学习作为一个独特主题

        1.  1.1 动机

        1.  1.2 财务机器学习项目通常失败的主要原因

        1.  1.3 书籍结构

        1.  1.4 目标受众

        1.  1.5 必备条件

        1.  1.6 常见问题解答

        1.  1.7 致谢

        1.  练习题

        1.  参考文献

        1.  参考书目

        1.  笔记

1.  第一部分 数据分析

    1.  第二章 财务数据结构

        1.  2.1 动机

        1.  2.2 财务数据的基本类型

        1.  2.3 条形图

        1.  2.4 处理多产品系列

        1.  2.5 特征采样

        1.  练习题

        1.  参考文献

    1.  第三章 标记

        1.  3.1 动机

        1.  3.2 固定时间范围方法

        1.  3.3 计算动态阈值

        1.  3.4 三重障碍法

        1.  3.5 学习侧面和规模

        1.  3.6 元标记

        1.  3.7 如何使用元标记

        1.  3.8 量化思维方式

        1.  3.9 删除不必要的标签

        1.  练习题

        1.  参考书目

        1.  注

    1.  第四章 示例权重

        1.  4.1 动机

        1.  4.2 重叠结果

        1.  4.3 同时标签的数量

        1.  4.4 标签的平均独特性

        1.  4.5 装袋分类器和独特性

        1.  4.6 回报归因

        1.  4.7 时间衰减

        1.  4.8 类别权重

        1.  练习

        1.  参考文献

        1.  参考书目

    1.  第五章 分数微分特征

        1.  5.1 动机

        1.  5.2 平稳性与记忆困境

        1.  5.3 文献综述

        1.  5.4 方法

        1.  5.5 实施

        1.  5.6 最大内存保存的平稳性

        1.  5.7 结论

        1.  练习

        1.  参考文献

        1.  参考书目

1.  第二部分 建模

    1.  第六章 集成方法

        1.  6.1 动机

        1.  6.2 三种误差来源

        1.  6.3 自助聚合

        1.  6.4 随机森林

        1.  6.5 提升法

        1.  6.6 财务中的袋装法与提升法

        1.  6.7 可扩展性的袋装法

        1.  练习

        1.  参考文献

        1.  参考书目

        1.  笔记

    1.  第七章 财务中的交叉验证

        1.  7.1 动机

        1.  7.2 交叉验证的目标

        1.  7.3 为什么 K 折交叉验证在财务中失败

        1.  7.4 解决方案：清理的 K 折交叉验证

        1.  7.5 Sklearn 的交叉验证中的错误

        1.  练习

        1.  参考书目

    1.  第八章 特征重要性

        1.  8.1 动机

        1.  8.2 特征重要性的重要性

        1.  8.3 带替代效应的特征重要性

        1.  8.4 无替代效应的特征重要性

        1.  8.5 并行与堆叠特征重要性

        1.  8.6 使用合成数据的实验

        1.  练习

        1.  参考文献

        1.  注释

    1.  第九章 超参数调整与交叉验证

        1.  9.1 动机

        1.  9.2 网格搜索交叉验证

        1.  9.3 随机搜索交叉验证

        1.  9.4 评分和超参数调优

        1.  练习

        1.  参考文献

        1.  书目

        1.  注释

1.  第三部分 回测

    1.  第十章 投注规模

        1.  10.1 动机

        1.  10.2 独立于策略的投注规模方法

        1.  10.3 基于预测概率的投注规模

        1.  10.4 活动投注的平均值

        1.  10.5 尺寸离散化

        1.  10.6 动态投注规模和限制价格

        1.  练习

        1.  参考文献

        1.  书目

        1.  注释

    1.  第十一章 回测的危险

        1.  11.1 动机

        1.  11.2 不可能的任务：完美回测

        1.  11.3 即使你的回测完美，它也可能是错误的

        1.  11.4 回测不是研究工具

        1.  11.5 一些一般性建议

        1.  11.6 策略选择

        1.  练习

        1.  参考文献

        1.  书目

        1.  注

    1.  第十二章 通过交叉验证进行回测

        1.  12.1 动机

        1.  12.2 前行法

        1.  12.3 交叉验证法

        1.  12.4 组合清理交叉验证法

        1.  12.5 组合清理交叉验证如何解决回测过拟合

        1.  练习

        1.  参考文献

    1.  第十三章 在合成数据上回测

        1.  13.1 动机

        1.  13.2 交易规则

        1.  13.3 问题

        1.  13.4 我们的框架

        1.  13.5 最优交易规则的数值确定

        1.  13.6 实验结果

        1.  13.7 结论

        1.  练习

        1.  参考文献

        1.  注释

    1.  第十四章 回测统计

        1.  14.1 动机

        1.  14.2 回测统计的类型

        1.  14.3 一般特征

        1.  14.4 绩效

        1.  14.5 跑道

        1.  14.6 实施短缺

        1.  14.7 效率

        1.  14.8 分类分数

        1.  14.9 归因

        1.  练习

        1.  参考文献

        1.  参考书目

        1.  注释

    1.  第十五章 理解策略风险

        1.  15.1 动机

        1.  15.2 对称支付

        1.  15.3 非对称支付

        1.  15.4 策略失败的概率

        1.  练习

        1.  参考文献

    1.  第十六章 机器学习资产配置

        1.  16.1 动机

        1.  16.2 凸组合优化的问题

        1.  16.3 马科维茨的诅咒

        1.  16.4 从几何关系到层次关系

        1.  16.5 数值示例

        1.  16.6 超出样本的蒙特卡洛模拟

        1.  16.7 进一步研究

        1.  16.8 结论

        1.  附录

        1.  16.A.1 基于相关性的度量

        1.  16.A.2 反向方差配置

        1.  16.A.3 复制数值示例

        1.  16.A.4 复制蒙特卡洛实验

        1.  练习

        1.  参考文献

        1.  注释

1.  第四部分 有用的金融特征

    1.  第十七章 结构性断裂

        1.  17.1 动机

        1.  17.2 结构性断裂测试的类型

        1.  17.3 CUSUM 测试

        1.  17.4 爆炸性测试

        1.  练习

        1.  参考文献

    1.  第十八章 熵特征

        1.  18.1 动机

        1.  18.2 香农熵

        1.  18.3 插件（或最大似然）估计器

        1.  18.4 兰佩尔-齐夫估计器

        1.  18.5 编码方案

        1.  18.6 高斯过程的熵

        1.  18.7 熵与广义均值

        1.  18.8 熵的一些金融应用

        1.  练习题

        1.  参考文献

        1.  参考书目

        1.  注意

    1.  第十九章 微观结构特征

        1.  19.1 动机

        1.  19.2 文献回顾

        1.  19.3 第一代：价格序列

        1.  19.4 第二代：战略交易模型

        1.  19.5 第三代：顺序交易模型

        1.  19.6 微观结构数据集的附加特征

        1.  19.7 什么是微观结构信息？

        1.  练习题

        1.  参考文献列表

1.  第五部分 高性能计算食谱

    1.  第二十章 多处理与向量化

        1.  20.1 动机

        1.  20.2 向量化示例

        1.  20.3 单线程与多线程与多处理

        1.  20.4 原子与分子

        1.  20.5 多处理引擎

        1.  20.6 多处理示例

        1.  练习题

        1.  参考文献

        1.  参考书目

        1.  注释

    1.  第二十一章 粗暴搜索与量子计算机

        1.  21.1 动机

        1.  21.2 组合优化

        1.  21.3 目标函数

        1.  21.4 问题

        1.  21.5 整数优化方法

        1.  21.6 数值示例

        1.  练习题

        1.  参考文献

    1.  第二十二章 高性能计算智能与预测技术

        1.  22.1 动机

        1.  22.2 对 2010 年闪电崩盘的监管响应

        1.  22.3 背景

        1.  22.4 HPC 硬件

        1.  22.5 HPC 软件

        1.  22.6 用例

        1.  22.7 总结与参与邀请

        1.  22.8 致谢

        1.  参考文献

        1.  注释

1.  索引

1.  最终用户许可协议 (EULA)

**表格列表**

1.  第一章

    1.  **表 1.1**

    1.  **表 1.2**

1.  第二章

    1.  **表 2.1**

1.  第五章

    1.  **表 5.1**

1.  第十三章

    1.  **表 13.1**

1.  第十四章

    1.  **表 14.1**

1.  第十六章

    1.  **表 16.1**

1.  第十七章

    1.  **表 17.1**

**插图列表**

1.  第二章

    1.  **图 2.1**

    1.  **图 2.2**

    1.  **图 2.3**

1.  第三章

    1.  **图 3.1**

    1.  **图 3.2**

1.  第四章

    1.  **图 4.1**

    1.  **图 4.2**

    1.  **图 4.3**

1.  第五章

    1.  **图 5.1**

    1.  **图 5.2**

    1.  **图 5.3**

    1.  **图 5.4**

    1.  **图 5.5**

1.  第六章

    1.  **图 6.1**

    1.  **图 6.2**

    1.  **图 6.3**

1.  第七章

    1.  **图 7.1**

    1.  **图 7.2**

    1.  **图 7.3**

1.  第八章

    1.  **图 8.1**

    1.  **图 8.2**

    1.  **图 8.3**

    1.  **图 8.4**

1.  第九章

    1.  **图 9.1**

    1.  **图 9.2**

1.  第十章

    1.  **图 10.1**

    1.  **图 10.2**

    1.  **图 10.3**

1.  第十一章

    1.  **图 11.1**

    1.  **图 11.2**

1.  第十二章

    1.  **图 12.1**

    1.  **图 12.2**

1.  第十三章

    1.  **图 13.1**

    1.  **图 13.2**

    1.  **图 13.3**

    1.  **图 13.4**

    1.  **图 13.5**

    1.  **图 13.6**

    1.  **图 13.7**

    1.  **图 13.8**

    1.  **图 13.9**

    1.  **图 13.10**

    1.  **图 13.11**

    1.  **图 13.12**

    1.  **图 13.13**

    1.  **图 13.14**

    1.  **图 13.15**

    1.  **图 13.16**

    1.  **图 13.17**

    1.  **图 13.18**

    1.  **图 13.19**

    1.  **图 13.20**

    1.  **图 13.21**

    1.  **图 13.22**

    1.  **图 13.23**

    1.  **图 13.24**

    1.  **图 13.25**

1.  第十四章

    1.  **图 14.1**

    1.  **图 14.2**

    1.  **图 14.3**

1.  第十五章

    1.  **图 15.1**

    1.  **图 15.2**

    1.  **图 15.3**

1.  第十六章

    1.  **图 16.1**

    1.  **图 16.2**

    1.  **图 16.3**

    1.  **图 16.4**

    1.  **图 16.5**

    1.  **图 16.6**

    1.  **图 16.7**

    1.  **图 16.8**

1.  第十七章

    1.  **图 17.1**

    1.  **图 17.2**

    1.  **图 17.3**

1.  第十八章

    1.  **图 18.1**

    1.  **图 18.2**

1.  第十九章

    1.  **图 19.1**

    1.  **图 19.2**

    1.  **图 19.3**

1.  第二十章

    1.  **图 20.1**

    1.  **图 20.2**

1.  第二十一章

    1.  **图 21.1**

1.  第二十二章

    1.  **图 22.1**

    1.  **图 22.2**

    1.  **图 22.3**

    1.  **图 22.4**

    1.  **图 22.5**

    1.  **图 22.6**

    1.  **图 22.7**

    1.  **图 22.8**

    1.  **图 22.9**

    1.  **图 22.10**

**关于作者**

**马科斯·洛佩斯·德·普拉多**使用机器学习算法为机构投资者管理多个数十亿资金的基金。在过去的 20 年中，他的工作将高级数学与超级计算技术结合起来，为投资者和公司带来了数十亿美元的净利润。作为合作研究的倡导者，马科斯与 30 多位顶尖学者合作发表论文，结果是一些在金融领域阅读量最大的论文。

自 2010 年以来，马科斯还在劳伦斯伯克利国家实验室（美国能源部科学办公室）担任研究员，他的研究重点是大规模金融问题的数学和计算研究部门的高性能计算。在过去的七年里，他在康奈尔大学授课，目前在运筹学系教授金融大数据和机器学习的研究生课程。

马科斯是 1999 年国家学术优秀奖的获得者，该奖项由西班牙政府授予全国最优秀的研究生。他于 2003 年获得马德里自治大学的金融经济学博士学位，并于 2011 年获得数学金融博士学位。在获得两个博士学位之间，马科斯在哈佛大学担任 RCC 的博士后研究员三年，期间他在 JCR 索引的科学期刊上发表了十多篇文章。根据美国数学学会的标准，马科斯拥有一个 ![](img/Image00526.jpg) #2 和一个爱因斯坦 #4。

**前言**

1.  第一章 金融机器学习作为一个独立的学科

